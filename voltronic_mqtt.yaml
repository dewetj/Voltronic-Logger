mqtt:
  sensor:
  - name: "grid-voltage"
    unique_id: "voltronic-s1"
    state_topic: "/garage/inverter"
    unit_of_measurement: "V"
    value_template: "{{ value_json.grid_voltage }}"
    state_class: measurement
    device_class: voltage
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "grid-frequency"
    unique_id: "voltronic-s2"
    state_topic: "/garage/inverter"
    unit_of_measurement: "Hz"
    value_template: "{{ value_json.grid_frequency }}"
    state_class: measurement
    device_class: frequency
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "inverter-voltage"
    unique_id: "voltronic-s3"
    state_topic: "/garage/inverter"
    unit_of_measurement: "V"
    value_template: "{{ value_json.inverter_voltage }}"
    state_class: measurement
    device_class: voltage
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "inverter-frequency"
    unique_id: "voltronic-s4"
    state_topic: "/garage/inverter"
    unit_of_measurement: "Hz"
    value_template: "{{ value_json.inverter_frequency }}"
    state_class: measurement
    device_class: frequency
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "inverter-apparent-output"
    unique_id: "voltronic-s5"
    state_topic: "/garage/inverter"
    unit_of_measurement: "VA"
    value_template: "{{ value_json.inverter_apparent_output }}"
    state_class: measurement
    device_class: apparent_power
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "inverter-active-power"
    unique_id: "voltronic-s6"
    state_topic: "/garage/inverter"
    unit_of_measurement: "W"
    value_template: "{{ value_json.inverter_active_power }}"
    state_class: measurement
    device_class: power
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "inverter-load"
    unique_id: "voltronic-s7"
    state_topic: "/garage/inverter"
    unit_of_measurement: "%"
    value_template: "{{ value_json.inverter_load}}"
    state_class: measurement
    device_class: power_factor
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "bus-voltage"
    unique_id: "voltronic-s8"
    state_topic: "/garage/inverter"
    unit_of_measurement: "V"
    value_template: "{{ value_json.bus_voltage}}"
    device_class: voltage
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "battery-voltage"
    unique_id: "voltronic-s9"
    state_topic: "/garage/inverter"
    unit_of_measurement: "V"
    value_template: "{{ value_json.battery_voltage}}"
    force_update: true
    state_class: measurement
    device_class: voltage
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "charge-current"
    unique_id: "voltronic-s10"
    state_topic: "/garage/inverter"
    unit_of_measurement: "A"
    value_template: "{{ value_json.charge_current}}"
    state_class: measurement
    device_class: current
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "battery-capacity"
    unique_id: "voltronic-s11"
    state_topic: "/garage/inverter"
    unit_of_measurement: "%"
    value_template: "{{ value_json.battery_capacity}}"
    state_class: measurement
    device_class: battery
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "inverter-temperature"
    unique_id: "voltronic-s12"
    state_topic: "/garage/inverter"
    unit_of_measurement: "Â°C"
    value_template: "{{ value_json.inverter_temperature}}"
    state_class: measurement
    device_class: temperature
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "pv-input-current"
    unique_id: "voltronic-s13"
    state_topic: "/garage/inverter"
    unit_of_measurement: "A"
    value_template: "{{ value_json.pv_input_current}}"
    state_class: measurement
    device_class: current
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "pv-input-voltage"
    unique_id: "voltronic-s14"
    state_topic: "/garage/inverter"
    unit_of_measurement: "V"
    value_template: "{{ value_json.pv_input_voltage}}"
    state_class: measurement
    device_class: voltage
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "battery-voltage-scc"
    unique_id: "voltronic-s15"
    state_topic: "/garage/inverter"
    unit_of_measurement: "V"
    value_template: "{{ value_json.battery_voltage_scc}}"
    device_class: voltage
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "discharge-current"
    unique_id: "voltronic-s16"
    state_topic: "/garage/inverter"
    unit_of_measurement: "A"
    value_template: "{{ value_json.discharge_current}}"
    state_class: measurement
    device_class: current
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "inverter-status"
    unique_id: "voltronic-s17"
    state_topic: "/garage/inverter"
    value_template: "{{ value_json.inverter_status}}"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "battery-voltage-offset-fan"
    unique_id: "voltronic-s18"
    state_topic: "/garage/inverter"
    unit_of_measurement: "V"
    value_template: "{{ value_json.battery_voltage_offset_fan}}"
    device_class: voltage
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "eeprom-version"
    unique_id: "voltronic-s19"
    state_topic: "/garage/inverter"
    value_template: "{{ value_json.eeprom_version}}"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "pv-in-power"
    unique_id: "voltronic-s20"
    state_topic: "/garage/inverter"
    unit_of_measurement: "W"
    value_template: "{{ value_json.pv_in_power}}"
    state_class: measurement
    device_class: power
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "device-status"
    unique_id: "voltronic-s21"
    state_topic: "/garage/inverter"
    value_template: "{{ value_json.device_status}}"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "mode"
    unique_id: "voltronic-s22"
    state_topic: "/garage/inverter"
    value_template: "{{ value_json.mode}}"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  ### Calculated sensors
  - name: "battery-discharge-power"
    unique_id: "voltronic-s23"
    state_topic: "/garage/inverter"
    unit_of_measurement: "W"
    force_update: true
    value_template: "{{ value_json.battery_voltage * value_json.discharge_current}}"
    state_class: measurement
    device_class: power
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "battery-charge-power"
    unique_id: "voltronic-s24"
    state_topic: "/garage/inverter"
    unit_of_measurement: "W"
    force_update: true
    value_template: "{{value_json.battery_voltage * value_json.charge_current}}"
    state_class: measurement
    device_class: power
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "grid-active-power"
    unique_id: "voltronic-s25"
    state_topic: "/garage/inverter"
    unit_of_measurement: "W"
    force_update: true
    value_template: |-
      {% if value_json.grid_voltage > 0 %}
        {% if (value_json.inverter_active_power + (value_json.battery_voltage * value_json.charge_current)) - (value_json.pv_in_power + (value_json.battery_voltage * value_json.discharge_current)) < 0 %}
          {{ 0 }}
        {% else %}
          {{ (value_json.inverter_active_power + (value_json.battery_voltage * value_json.charge_current)) - (value_json.pv_in_power + (value_json.battery_voltage * value_json.discharge_current))  }}
        {% endif %}
      {% else %}
        {{ 0 }}
      {% endif %}
    state_class: measurement
    device_class: power
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "charger-source-priority"
    unique_id: "voltronic-s26"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.charger_source_priority == "0" %}
        {{ "Utility First" }}
      {% elif value_json.charger_source_priority == "1" %}
        {{ "Solar First" }}
      {% elif value_json.charger_source_priority == "2" %}
        {{ "Solar & Utility" }}
      {% elif value_json.charger_source_priority == "3" %}
        {{ "Solar Only" }}
      {% else %}
        {{ "Unavailable" }}
      {% endif %}
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "output-source-priority"
    unique_id: "voltronic-s27"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.output_source_priority == "0" %}
        {{ "Utility Solar Battery" }}
      {% elif value_json.output_source_priority == "1" %}
        {{ "Solar Utility Battery" }}
      {% elif value_json.output_source_priority == "2" %}
        {{ "Solar Battery Utility" }}
      {% else %}
        {{ "Unknown" }}
      {% endif %}
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  ## switches
  switch:
  - name: "charge-uti"
    unique_id: "voltronic-t1"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.charger_source_priority == "0" %}
        {{ "1" }}
      {% else %}
        {{ "0" }}
      {% endif %}
    command_topic: "/garage/inverter/command"
    state_on: "1"
    state_off: "0"
    payload_on: "PCP00"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "charge-sol"
    unique_id: "voltronic-t2"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.charger_source_priority == "1" %}
        {{ "1" }}
      {% else %}
        {{ "0" }}
      {% endif %}
    command_topic: "/garage/inverter/command"
    state_on: "1"
    state_off: "0"
    payload_on: "PCP01"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "charge-snu"
    unique_id: "voltronic-t3"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.charger_source_priority == "2" %}
        {{ "1" }}
      {% else %}
        {{ "0" }}
      {% endif %}
    command_topic: "/garage/inverter/command"
    state_on: "1"
    state_off: "0"
    payload_on: "PCP02"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "charge-oso"
    unique_id: "voltronic-t4"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.charger_source_priority == "3" %}
        {{ "1" }}
      {% else %}
        {{ "0" }}
      {% endif %}
    command_topic: "/garage/inverter/command"
    state_on: "1"
    state_off: "0"
    payload_on: "PCP03"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "output-usb"
    unique_id: "voltronic-t5"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.output_source_priority == "0" %}
        {{ "1"}}
      {% else %}
        {{ "0" }}
      {% endif %}
    command_topic: "/garage/inverter/command"
    state_on: "1"
    state_off: "0"
    payload_on: "POP00"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "output-sub"
    unique_id: "voltronic-t6"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.output_source_priority == "1" %}
        {{ "1" }}
      {% else %}
        {{ "0" }}
      {% endif %}
    command_topic: "/garage/inverter/command"
    state_on: "1"
    state_off: "0"
    payload_on: "POP01"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}
  - name: "output-sbu"
    unique_id: "voltronic-t7"
    state_topic: "/garage/inverter"
    value_template: |-
      {% if value_json.output_source_priority == "2" %}
        {{ "1" }}
      {% else %}
        {{ "0" }}
      {% endif %}
    command_topic: "/garage/inverter/command"
    state_on: "1"
    state_off: "0"
    payload_on: "POP02"
    device: {"name": "Voltronic Inverter", "identifiers": "SN Here", "manufacturer": "Kodak", "model": "OGX5.48a"}